<%- include('layout/header') %>
<script src="https://cdn.jsdelivr.net/npm/frappe-charts@1.2.4/dist/frappe-charts.min.iife.js"></script>

<style>
  /* Ensure the container leaves 25px space for the sidebar */
  body {
    margin-left: 25px; /* Leave space for the sidebar */
  }

  #positionTabs {
    display: flex;
    justify-content: center;
    margin-top: 20px;
    flex-wrap: wrap; /* Ensure tabs wrap on smaller screens */
  }

  .tab-content {
    display: flex;
    justify-content: center;
    align-items: center;
    overflow-x: auto; /* Allow horizontal scrolling */
    flex-direction: column; /* Stack charts vertically on smaller screens */
  }

  .tab-pane > div {
    margin: 0 auto;
    width: 90%; /* Use percentage for better responsiveness */
    max-width: 900px;
    height: 500px;
  }

  /* Large screens */
  @media only screen and (min-width: 1024px) {
    .tab-pane > div {
      width: 900px;
      height: 500px;
    }
  }

  /* Medium Devices */
  @media only screen and (max-width: 1024px) {
    .tab-pane > div {
      width: 700px;
      height: 400px;
    }
  }

  /* Small Devices */
  @media only screen and (max-width: 600px) {
    .tab-pane > div {
      width: 90%; /* Adjust width for small screens */
      height: 300px;
    }

    #fullName {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 55px;
      display: inline-block;
      vertical-align: middle;
    }
  }
</style>
</head>
<body>
  <header>
    <!-- Sidebar -->
    <%- include('./layout/analysis') -%>

    <!-- Navbar -->
    <%- include('./layout/navbar') -%>
  </header>
  <main>
  <div class="container mt-5">
    <h1 class="text-center" style="margin-top: 80px;">Voter Analysis</h1>
    <div id="chart"></div>
  </div>
</main>
  <script>
    const groupedData = <%- groupedData %>;

    Object.keys(groupedData).forEach((position) => {
      const positionData = groupedData[position];
      const container = document.createElement("div");
      container.id = `chart-${position}`;
      container.style.marginBottom = "20px";
      document.getElementById("chart").appendChild(container);

      const data = {
        labels: positionData.labels,
        datasets: [
          {
            name: "Votes",
            type: "bar",
            values: positionData.votes,
          },
        ],
      };

      new frappe.Chart(`#chart-${position}`, {
        title: `${position} - Vote Analysis`,
        data: data,
        type: "bar",
        height: 300,
        colors: ["#008B8B"],
      });
    });
  </script>

<%- include('layout/footer') %>
